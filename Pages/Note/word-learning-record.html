<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>英语单词学习记录 - NEGIAO</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js" defer></script>
    <script defer src="../notes-toc.js"></script>
    <style>
        /* TOC toggle button style */
        #toc-toggle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 99999;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: fixed;
            top: 20px;
            right: 20px;
            border: none;
            color: white;
            transition: transform 0.3s ease;
        }

        #toc-toggle:hover {
            transform: scale(1.1);
        }

        /* Word test container styles */
        .word-test-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            padding: 20px;
            margin: 20px auto 30px;
            max-width: 800px;
        }

        .word-test-container h2 {
            text-align: center;
            margin-bottom: 15px;
            color: white;
            font-weight: 600;
        }

        .test-stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .stat-item {
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }

        .test-card {
            background: white;
            border-radius: 8px;
            padding: 25px;
            color: #333;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .test-question h3 {
            font-size: 28px;
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .question-text {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 20px;
            font-size: 16px;
        }

        .test-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .option-btn {
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            background: white;
            color: #333;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 15px;
            text-align: center;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .option-btn:hover {
            border-color: #667eea;
            background: #f8f9fa;
        }

        .option-btn.correct {
            border-color: #28a745;
            background: #d4edda;
            color: #155724;
        }

        .option-btn.wrong {
            border-color: #dc3545;
            background: #f8d7da;
            color: #721c24;
        }

        .option-btn.disabled {
            pointer-events: none;
            opacity: 0.7;
        }

        .test-controls {
            text-align: center;
        }

        .test-result {
            text-align: center;
            margin-top: 15px;
            font-size: 16px;
            font-weight: 500;
        }

        .test-result.correct {
            color: #28a745;
        }

        .test-result.wrong {
            color: #dc3545;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5a6fd8;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        @media (max-width: 768px) {
            .test-options {
                grid-template-columns: 1fr;
            }
            
            .test-stats {
                flex-direction: column;
                align-items: center;
            }
            
            .word-test-container {
                padding: 15px;
            }
            
            .test-card {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="navbar__container">
            <a href="../../index.html" class="navbar__brand">NEGIAO</a>
            <a href="../notes.html" class="btn btn--secondary">返回索引</a>
        </div>
    </nav>

    <main class="container section note-layout">

        <aside class="note-toc card" aria-label="文章章节目录">
            <nav class="note-toc__nav" id="note-toc"></nav>
        </aside>
        
        <!-- TOC Toggle Button -->
        <button id="toc-toggle" aria-expanded="true" title="切换章节索引显示/隐藏">
            <i class="fas fa-list"></i>
        </button>

        <!-- 单词测试区域 -->
        <div id="word-test-section" class="word-test-container">
            <h2>🎯 每日单词测试</h2>
            <div class="test-stats">
                <span class="stat-item">正确: <span id="correct-count">0</span></span>
                <span class="stat-item">错误: <span id="wrong-count">0</span></span>
                <span class="stat-item">准确率: <span id="accuracy">0%</span></span>
            </div>
            
            <div id="test-card" class="test-card">
                <div class="test-question">
                    <h3 id="test-word">Loading...</h3>
                    <p class="question-text">请选择正确的中文含义 (答对自动跳转下一题)</p>
                </div>
                
                <div class="test-options" id="test-options">
                    <!-- 选项将由JavaScript动态生成 -->
                </div>
                
                <div class="test-controls">
                    <button id="next-word-btn" class="btn btn-primary" style="display: none;">下一题</button>
                    <button id="start-test-btn" class="btn btn-secondary">开始测试</button>
                </div>
                
                <div id="test-result" class="test-result" style="display: none;">
                    <!-- 结果反馈 -->
                </div>
            </div>
        </div>

        <article class="note-content card" id="note-content">
            <script type="text/markdown" id="note-markdown">
# 📚 英语单词学习记录

个人英语单词学习笔记，记录日常学习中遇到的生词、短语和表达。按学习时间和主题分类整理。

## 📅 2025年9月学习记录

### 2025-09-10 新增单词

| 单词 | 词性 | 中文释义 | 例句/用法 |
|------|------|----------|-----------|
| **Sanction** | n./v. | 制裁；批准 | The government imposed economic sanctions on the country. |
| **Forge** | v. | 伪造；锻造 | He was arrested for forging documents. |
| **Evade** | v. | 逃避；规避 | It's illegal to evade responsibility. |
| **Spectacle** | n. | 景象；奇观 | The fireworks created a spectacular spectacle. |
| **Sprawl** | v./n. | 蔓延；四肢伸开的姿势 | Urban sprawl is a major environmental concern. |
| **Culmination** | n. | 高潮；顶点 | This achievement is the culmination of years of hard work. |
| **Conspire** | v. | 共谋；阴谋 | They conspired to overthrow the government. |
| **Mitigate** | v. | 缓解；减轻 | We need to mitigate the effects of climate change. |
| **Wired** | adj. | 兴奋的；紧张的 | I'm too wired to sleep after all that caffeine. |

### 2025-09-13 新增单词


| 单词 | 词性 | 中文释义 | 例句/用法 |
|------|------|----------|-----------|
| **Gorgeous** | adj. | 华丽的；极美的 | The sunset was absolutely gorgeous tonight. |
| **Grip** | n./v. | 紧握；掌控 | She had a firm grip on the steering wheel. / The movie gripped the audience from start to finish. |
| **Entail** | v. | 需要；涉及 | The new position will entail more responsibilities. |
| **Wholesome** | adj. | 健康的；有益的 | She preferred wholesome activities like hiking and reading. |
| **Exacerbate** | v. | 使恶化；加剧 | The heavy rain will exacerbate the flooding situation. |
| **Endorse** | v. | 支持；认可 | The celebrity decided to endorse the new product. |

<!-- 2025-09-29 原本附加的释义表格已移动至 2025-09-13 条目以保持日期准确性 -->

### 2025-09-16 新增单词

| 单词 | 词性 | 中文释义 | 例句/用法 |
|------|------|----------|-----------|
| **Culprit** | n. | 罪犯；祸首 | The police finally caught the culprit behind the theft. |
| **Rehearse** | v. | 排练；预演 | The actors need to rehearse their lines before opening night. |
| **Deplete** | v. | 耗尽；削减 | Overfishing has depleted the ocean's fish population. |
| **Toxic** | adj. | 有毒的；有害的 | The factory released toxic chemicals into the river. |
| **Nocturnal** | adj. | 夜间活动的 | Owls are nocturnal birds that hunt at night. |
| **Diurnal** | adj. | 白天活动的 | Most humans follow a diurnal pattern of activity. |
| **Predilection** | n. | 偏好；嗜好 | She has a predilection for classical music. |
| **Loathe** | v. | 厌恶；憎恨 | I loathe having to wake up early on weekends. |
| **Attitude** | n. | 态度；看法 | His positive attitude toward challenges is inspiring. |
| **Altitude** | n. | 高度；海拔 | The plane is flying at an altitude of 30,000 feet. |
| **Aptitude** | n. | 天赋；才能 | She shows great aptitude for learning languages. |
| **Longitude** | n. | 经度 | The longitude of Beijing is approximately 116°E. |
| **Latitude** | n. | 纬度；自由度 | The latitude of the equator is 0 degrees. |
| **Gratitude** | n. | 感激；感谢 | I want to express my gratitude for your help. |
| **Destitute** | adj. | 贫困的；缺乏的 | The war left many families destitute and homeless. |
| **Solitude** | n. | 孤独；独处 | He enjoys the solitude of his mountain cabin. |

### 2025-09-19 新增单词 

| 单词 | 词性 | 中文释义 | 例句/用法 |
|------|------|----------|-----------|
| **Render** | v./n. | 渲染；呈现 | The computer takes time to render high-quality 3D graphics. |
| **Batch** | n./v. | 批次；批量处理 | We need to process this batch of data before midnight. |
| **Rectify** | v. | 纠正；校正 | The engineer worked to rectify the calibration errors. |
| **Distortion** | n. | 扭曲；失真 | The lens caused significant distortion in the image. |

### 2025-09-21 新增单词 

| 单词 | 词性 | 中文释义 | 例句/用法 |
|------|------|----------|-----------|
| **Retain** | v. | 保持；保留；记住 | Students must retain information for the exam. |
| **Obtain** | v. | 获得；得到；取得 | She worked hard to obtain her degree. |
| **Domain** | n. | 领域；域名；范围 | Artificial intelligence is a rapidly growing domain. |
| **Sustain** | v. | 维持；承受；支撑 | The bridge can sustain heavy traffic loads. |
| **Contain** | v. | 包含；控制；容纳 | The box contains important documents. |
| **Deceit** | n. | 欺骗；诡计；虚假 | His business failed due to deceit and fraud. |
| **Maintain** | v. | 维护；保持；坚持 | Regular exercise helps maintain good health. |
| **Deceive** | v. | 欺骗；误导；蒙蔽 | Don't let appearances deceive you. |
| **Detach** | v. | 分离；拆卸；脱离 | Please detach the receipt from the bill. |
| **Fraction** | n. | 分数；部分；碎片 | Calculate the fraction representing the ratio. |
| **Magnitude** | n. | 大小；重要性；震级 | The earthquake registered a magnitude of 7.2. |
| **Spit** | v./n. | 吐；唾液 | The angry customer began to spit insults. |
| **Faculty** | n. | 学院；能力；全体教员 | The medical faculty published groundbreaking research. |
| **Dissipate** | v. | 消散；挥霍；放纵 | Heat energy will dissipate quickly in the cold. |
| **Ore** | n. | 矿石；矿物 | The company extracted iron ore from the mountain. |
| **Corrode** | v. | 腐蚀；侵蚀 | Acidic rain will corrode the metal infrastructure. |
| **Symposium** | n. | 研讨会；座谈会 | The international symposium brought together experts. |
| **Porter** | n. | 搬运工；门房 | The hotel porter helped guests with their luggage. |
| **Detain** | v. | 拘留；耽搁；阻止 | Police will detain suspects for questioning. |
| **Desolate** | adj./v. | 荒凉的；使荒凉 | The abandoned town looked desolate. |

### 2025-09-22 新增单词 

| 单词 | 词性 | 中文释义 | 例句/用法 |
|------|------|----------|-----------|
| **Crystal** | n./adj. | 水晶；晶体；透明的 | The crystal structure of diamonds makes them extremely hard. |
| **Decent** | adj. | 体面的；像样的；正派的 | He earns a decent salary at his new job. |
| **Crust** | n./v. | 地壳；外壳；结硬皮 | The Earth's crust is constantly moving due to tectonic activity. |
| **Decay** | n./v. | 衰退；腐烂；衰变 | The old building shows signs of decay and neglect. |
| **Faculty** | n. | 学院；能力；全体教员 | She joined the faculty of medicine last year. |

### 2025-09-23 新增单词 

| 单词 | 词性 | 中文释义 | 例句/用法 |
|------|------|----------|-----------|
| **Negligible** | adj. | 微不足道的；可忽略的 | The side effects of this medication are negligible. |
| **Negligent** | adj. | 疏忽的；失职的 | The company was found negligent in maintaining safety standards. |
| **Plausible** | adj. | 看似合理的；可信的 | Her explanation sounds plausible, but we need more evidence. |
| **Cosmic** | adj. | 宇宙的；巨大的 | The cosmic radiation affects satellite communications. |
| **Liable** | adj. | 有责任的；倾向于 | The driver is liable for the damages caused by the accident. |
| **Formulate** | v. | 制定；阐述；配制 | Scientists are working to formulate a new theory about dark matter. |
| **Whirl** | v./n. | 旋转；忙乱；尝试 | The dancer began to whirl across the stage gracefully. |
| **Latent** | adj. | 潜在的；隐藏的 | The latent talent in music became evident during his performance. |

### 2025-09-29 新增单词

| 单词         | 词义           | 记忆法/联想 |
|--------------|----------------|-------------|
| strip        | 剥夺；脱去     | strip sb. of rights 剥夺权利 |
| discrepancy  | 差异；不一致   | data discrepancy 数据差异 |
| discern      | 艰难察觉；识别 | discern a faint sound 艰难察觉声音 |
| deficiency   | 缺乏；不足     | vitamin deficiency 维生素缺乏 |
| momentum     | 动能；势头     | gain momentum 获得势头 |
| stall        | 停顿；拖延     | engine stall 发动机熄火/项目停滞 |

## 📅 2025年10月学习记录

### 2025-10-01 新增单词

| 单词 | 词性 | 中文释义 | 例句/用法 |
|------|------|----------|-----------|
| **Realm** | n. | 领域 | The digital realm offers endless possibilities for innovation. |
| **Stem** | v./n. | 源于、阻止、植物的根茎 | The problem stems from lack of communication. |
| **Shield** | n./v. | 保护 | The umbrella shielded us from the rain. |
| **Lure** | v./n. | 诱惑 | The company used high salaries to lure talented employees. |

### 2025-10-02 新增单词

| 单词 | 词性 | 中文释义 | 例句/用法 |
|------|------|----------|-----------|
| **Dim** | adj. | 黯淡的，没前途的 | The future looked dim without proper planning. |
| **Precede** | v. | 先于 | A loud bang preceded the explosion. |
| **Weary** | adj. | 疲劳的 | After the long journey, we felt weary and exhausted. |
| **Undaunted** | adj. | 顽强的 | She remained undaunted despite facing numerous challenges. |
| **Deluded** | adj. | 受骗的 | He was deluded into thinking he could get rich quickly. |
| **Salvage** | v./n. | 挽救 | They managed to salvage some equipment from the wreckage. |
| **Premise** | n. | 场地 | The company moved to a new premise downtown. |
| **Assertion** | n. | 断言，主张 | His assertion that the earth is flat was quickly disproven. |
| **Portend** | v. | 预示 | Dark clouds portend an incoming storm. |

### 2025-10-03 新增单词

| 单词 | 词性 | 中文释义 | 例句/用法 |
|------|------|----------|-----------||
| **Rack** | n./v. | 架子 | Please put the books back on the rack. |
| **Blast** | n./v. | 爆炸；批评 | The blast from the explosion shattered windows nearby. |
| **Veteran** | n./adj. | 有经验的老手 | The veteran teacher knew how to handle difficult students. |
| **Extinct** | adj. | 灭绝的 | Dinosaurs have been extinct for millions of years. |
| **Explicit** | adj. | 明确的；详细的 | The contract contains explicit terms and conditions. |
| **Distinct** | adj. | 不同的；清楚的 | Each snowflake has a distinct pattern. |
| **Instinct** | n. | 本能 | Animals rely on instinct for survival. |
| **Extinguish** | v. | 熄灭；消除 | Please extinguish all cigarettes before entering. |
| **Draft** | n./v. | 草稿；征兵 | She wrote the first draft of her novel last month. |
| **Drift** | v./n. | 漂流 | The boat began to drift away from the shore. |
| **Deck** | n. | 甲板 | Passengers gathered on the deck to watch the sunset. |
| **Heave** | v. | 举起 | They had to heave the heavy box onto the truck. |

### 2025-10-04 新增单词

| 单词 | 词性 | 中文释义 | 例句/用法 |
|------|------|----------|-----------|
| **Contender** | n. | 竞争者 | The contender for the championship trained hard every day. |
| **Mass** | n. | 群众、聚集、大量 | A mass of people gathered in the square. |
| **Chronic** | adj. | 长期的、慢性的 | He suffers from chronic back pain. |
| **Diversion** | n. | 娱乐、消遣 | Reading is a pleasant diversion after work. |

            </script>
    </article>
    </main>

    <!-- Load highlight.js with defer to improve page load performance -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js" defer></script>
    
    <script>
        // Optimized markdown rendering
        document.addEventListener('DOMContentLoaded', function() {
            // Process markdown asynchronously for better performance
            setTimeout(function() {
                const src = document.getElementById('note-markdown');
                if (!src) return;
                
                // Extract markdown content
                const md = src.textContent || src.innerText || '';
                
                // Process markdown in chunks for better responsiveness
                processMarkdown(md, function(html) {
                    const container = document.getElementById('note-content');
                    if (!container) return;
                    
                    // Insert the HTML
                    container.innerHTML = html;
                    
                    // Build table of contents
                    if (window.buildNoteTOC) {
                        requestAnimationFrame(function() {
                            window.buildNoteTOC();
                            
                            // Set up TOC toggle functionality
                            setupTocToggle();
                        });
                    }
                    
                    // 初始化单词测试
                    try {
                        new WordTest();
                    } catch (e) {
                        console.log('Word test initialization:', e);
                    }
                    
                    // Apply syntax highlighting
                    if (window.hljs) {
                        // Use requestIdleCallback for non-critical task if available
                        (window.requestIdleCallback || setTimeout)(function() {
                            container.querySelectorAll('pre code').forEach((block) => {
                                hljs.highlightBlock(block);
                            });
                        }, { timeout: 500 });
                    } else {
                        // Wait for highlight.js to load
                        window.onhljsready = function() {
                            container.querySelectorAll('pre code').forEach((block) => {
                                hljs.highlightBlock(block);
                            });
                        };
                    }
                });
            }, 0);
        });
        
        // Process markdown in chunks for better UI responsiveness
        function processMarkdown(md, callback) {
            // Use requestAnimationFrame to avoid blocking the main thread
            requestAnimationFrame(function() {
                let html;
                try {
                    // Use available markdown parser
                    if (window.marked) {
                        html = window.marked.parse(md);
                    } else if (window.markdownit) {
                        html = window.markdownit().render(md);
                    } else {
                        html = md; // Fallback
                    }
                    callback(html);
                } catch (e) {
                    console.error('Error parsing markdown:', e);
                    callback('<p>Error parsing markdown content.</p>');
                }
            });
        }
        
        // Set up TOC toggle functionality
        function setupTocToggle() {
            const tocToggle = document.getElementById('toc-toggle');
            const tocAside = document.querySelector('.note-toc');
            
            if (tocToggle && tocAside) {
                tocToggle.addEventListener('click', function() {
                    tocAside.classList.toggle('note-toc--collapsed');
                    const collapsed = tocAside.classList.contains('note-toc--collapsed');
                    tocToggle.setAttribute('aria-expanded', String(!collapsed));
                    
                    // 缓存状态到localStorage
                    try { 
                        localStorage.setItem('note-toc-collapsed', collapsed ? '1' : '0'); 
                    } catch (err) {}
                    
                    // 立即更新视觉状态
                    if (window.innerWidth >= 769) {
                        if (collapsed) {
                            tocAside.style.transform = 'translateY(-50%) translateX(120%)';
                            tocAside.style.right = '12px';
                        } else {
                            tocAside.style.transform = 'translateY(-50%) translateZ(0)';
                            tocAside.style.right = '28px';
                        }
                    }
                });
                
                // 恢复保存的状态
                try {
                    const saved = localStorage.getItem('note-toc-collapsed');
                    if (saved === '1') {
                        tocAside.classList.add('note-toc--collapsed');
                        if (window.innerWidth >= 769) {
                            tocAside.style.transform = 'translateY(-50%) translateX(120%)';
                            tocAside.style.right = '12px';
                        }
                        tocToggle.setAttribute('aria-expanded', 'false');
                    }
                } catch (err) {}
            }
        }
        
        // Set up highlight.js load callback
        if (typeof hljs === 'undefined') {
            window.addEventListener('load', function() {
                if (typeof hljs !== 'undefined' && typeof window.onhljsready === 'function') {
                    window.onhljsready();
                }
            });
        }

        // 单词测试功能
        class WordTest {
            constructor() {
                // 使用 JSON 文件作为首选数据来源，备用为内嵌词库
                this.words = [];
                // 备用词库
                this.fallbackWords = [
                    { word: 'sanction', meaning: '制裁；批准', options: ['制裁；批准', '伪造；锻造', '逃避；规避', '景象；奇观'] },
                    { word: 'forge', meaning: '伪造；锻造', options: ['制裁；批准', '伪造；锻造', '逃避；规避', '蔓延；伸展'] },
                    { word: 'evade', meaning: '逃避；规避', options: ['逃避；规避', '高潮；顶点', '共谋；阴谋', '缓解；减轻'] },
                    { word: 'spectacle', meaning: '景象；奇观', options: ['景象；奇观', '蔓延；伸展', '高潮；顶点', '共谋；阴谋'] },
                    { word: 'sprawl', meaning: '蔓延；伸展', options: ['蔓延；伸展', '高潮；顶点', '共谋；阴谋', '缓解；减轻'] },
                    { word: 'strip', meaning: '剥夺；脱去', options: ['剥夺；脱去', '差异；不一致', '缺乏；不足', '动能；势头'] },
                    { word: 'discrepancy', meaning: '差异；不一致', options: ['差异；不一致', '剥夺；脱去', '艰难察觉；识别', '停顿；拖延'] },
                    { word: 'momentum', meaning: '动能；势头', options: ['动能；势头', '剥夺；脱去', '差异；不一致', '艰难察觉；识别'] }
                ];
                
                this.currentWord = null;
                this.correctCount = 0;
                this.wrongCount = 0;
                this.isAnswered = false;
                
                this.initElements();
                this.bindEvents();
                
                // 初始化加载状态
                if (this.startBtn) {
                    this.startBtn.disabled = true;
                    this.startBtn.textContent = '加载词库中…';
                }
                
                // 异步加载词库
                this.loadWords();
            }
            
            initElements() {
                this.testWord = document.getElementById('test-word');
                this.testOptions = document.getElementById('test-options');
                this.nextBtn = document.getElementById('next-word-btn');
                this.startBtn = document.getElementById('start-test-btn');
                this.testResult = document.getElementById('test-result');
                this.correctCountEl = document.getElementById('correct-count');
                this.wrongCountEl = document.getElementById('wrong-count');
                this.accuracyEl = document.getElementById('accuracy');
            }
            
            bindEvents() {
                this.startBtn.addEventListener('click', () => this.startTest());
                this.nextBtn.addEventListener('click', () => this.nextQuestion());
            }
            
            async loadWords() {
                try {
                    // 首先尝试加载JSON文件
                    try {
                        // 路径相对于当前 HTML 文件 (Pages/Note/)
                        const resp = await fetch('./word-list.json', { cache: 'no-store' });
                        if (!resp.ok) throw new Error('Failed to load word-list.json');
                        const data = await resp.json();
                        // 只保留需要的字段，并确保选项数组包含正确答案
                        this.words = (Array.isArray(data) ? data : []).map(item => ({
                            word: String(item.word || '').trim(),
                            meaning: String(item.meaning || '').trim(),
                            options: Array.isArray(item.options) && item.options.length ? item.options.slice() : [String(item.meaning || '').trim()]
                        })).filter(w => w.word && w.meaning);
                        console.log('JSON词库加载成功，共', this.words.length, '个单词');
                    } catch (err) {
                        console.error('JSON加载失败，切换到内置词库:', err);
                        throw err; // 重新抛出以触发备用词库
                    }

                    // 如果JSON词库为空，使用备用词库
                    if (this.words.length === 0) {
                        console.log('JSON词库为空，使用备用词库');
                        this.words = this.fallbackWords;
                    }
                } catch (err) {
                    // 如果JSON加载失败，使用内置词库作为备用
                    console.log('使用备用词库');
                    this.words = this.fallbackWords;
                } finally {
                    console.log('词库准备完成，共', this.words.length, '个单词');
                    if (this.startBtn) {
                        this.startBtn.disabled = this.words.length === 0;
                        this.startBtn.textContent = this.words.length === 0 ? '词库加载失败' : '开始测试';
                    }
                }
            }
            
            startTest() {
                if (!this.words || this.words.length === 0) {
                    this.testWord.textContent = '词库未加载，无法开始测试';
                    return;
                }
                console.log('开始测试，可用单词：', this.words.length, '个');
                this.startBtn.style.display = 'none';
                this.nextQuestion();
            }
            
            nextQuestion() {
                this.isAnswered = false;
                this.testResult.style.display = 'none';
                this.nextBtn.style.display = 'none';
                
                // 随机选择单词（当词库为空时安全返回）
                if (!this.words || this.words.length === 0) {
                    this.testWord.textContent = '暂无词库数据';
                    this.testOptions.innerHTML = '';
                    return;
                }
                this.currentWord = this.words[Math.floor(Math.random() * this.words.length)];
                this.testWord.textContent = this.currentWord.word.toLowerCase();

                // 确保选项包含正确答案，并进行随机排序
                const optionSet = new Set(this.currentWord.options || []);
                optionSet.add(this.currentWord.meaning);
                const shuffledOptions = this.shuffleArray(Array.from(optionSet));

                // 生成选项按钮
                this.testOptions.innerHTML = '';
                shuffledOptions.forEach((option) => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.textContent = option;
                    btn.addEventListener('click', () => this.checkAnswer(option, btn));
                    this.testOptions.appendChild(btn);
                });
            }
            
            checkAnswer(selectedOption, btnElement) {
                if (this.isAnswered) return;
                
                this.isAnswered = true;
                const isCorrect = selectedOption === this.currentWord.meaning;
                
                // 禁用所有按钮并标记正确答案
                const allBtns = this.testOptions.querySelectorAll('.option-btn');
                allBtns.forEach(btn => {
                    btn.classList.add('disabled');
                    if (btn.textContent === this.currentWord.meaning) {
                        btn.classList.add('correct');
                    } else if (btn === btnElement && !isCorrect) {
                        btn.classList.add('wrong');
                    }
                });
                
                // 更新统计
                if (isCorrect) {
                    this.correctCount++;
                    this.testResult.textContent = '✅ 正确！正在跳转...';
                    this.testResult.className = 'test-result correct';
                    
                    // 正确答案：1.5秒后自动跳转下一题
                    setTimeout(() => {
                        this.nextQuestion();
                    }, 1500);
                } else {
                    this.wrongCount++;
                    this.testResult.textContent = `❌ 错误！正确答案是: ${this.currentWord.meaning}`;
                    this.testResult.className = 'test-result wrong';
                    
                    // 错误答案：显示下一题按钮，需要手动点击
                    this.nextBtn.style.display = 'inline-block';
                }
                
                this.updateStats();
                this.testResult.style.display = 'block';
            }
            
            updateStats() {
                this.correctCountEl.textContent = this.correctCount;
                this.wrongCountEl.textContent = this.wrongCount;
                
                const total = this.correctCount + this.wrongCount;
                const accuracy = total > 0 ? Math.round((this.correctCount / total) * 100) : 0;
                this.accuracyEl.textContent = accuracy + '%';
            }
            
            // Fisher-Yates 洗牌算法实现数组随机排序
            shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }
        }
        
        // 初始化单词测试 - 将在现有DOMContentLoaded事件中初始化
    </script>
</body>
</html>
