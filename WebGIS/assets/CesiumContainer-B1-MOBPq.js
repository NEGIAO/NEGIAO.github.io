import{V as _,S as L,C as I,a as s,b as P,c as R,U as x,W as f,d as O,L as D,e as v,f as p,g as k,H as A}from"./cesium-vendor-MWq2KeC0.js";import{_ as G,r as M,o as U,a as W,c as F,b as V,d as a,t as $,F as H}from"./index-B7eWaVWw.js";window.CESIUM_BASE_URL="cesium/";const z={class:"map-controls-group"},N={class:"mouse-position-content"},c="4267820f43926eaf808d61dc07269beb",j="https://mt3v.gggis.com/maps/vt?lyrs=s&x={x}&y={y}&z={z}",K={__name:"CesiumContainer",setup(Q){const y=["https://api.tianditu.gov.cn/cdn/plugins/cesium/Cesium_ext_min.js","https://api.tianditu.gov.cn/cdn/plugins/cesium/long.min.js","https://api.tianditu.gov.cn/cdn/plugins/cesium/bytebuffer.min.js","https://api.tianditu.gov.cn/cdn/plugins/cesium/protobuf.min.js"],g=[{x:6,y:1,level:2,boundBox:{minX:90,minY:0,maxX:135,maxY:45}},{x:7,y:1,level:2,boundBox:{minX:135,minY:0,maxX:180,maxY:45}},{x:6,y:0,level:2,boundBox:{minX:90,minY:45,maxX:135,maxY:90}},{x:7,y:0,level:2,boundBox:{minX:135,minY:45,maxX:180,maxY:90}},{x:5,y:1,level:2,boundBox:{minX:45,minY:0,maxX:90,maxY:45}},{x:4,y:1,level:2,boundBox:{minX:0,minY:0,maxX:45,maxY:45}},{x:5,y:0,level:2,boundBox:{minX:45,minY:45,maxX:90,maxY:90}},{x:4,y:0,level:2,boundBox:{minX:0,minY:45,maxX:45,maxY:90}},{x:6,y:2,level:2,boundBox:{minX:90,minY:-45,maxX:135,maxY:0}},{x:6,y:3,level:2,boundBox:{minX:90,minY:-90,maxX:135,maxY:-45}},{x:7,y:2,level:2,boundBox:{minX:135,minY:-45,maxX:180,maxY:0}},{x:5,y:2,level:2,boundBox:{minX:45,minY:-45,maxX:90,maxY:0}},{x:4,y:2,level:2,boundBox:{minX:0,minY:-45,maxX:45,maxY:0}},{x:3,y:1,level:2,boundBox:{minX:-45,minY:0,maxX:0,maxY:45}},{x:3,y:0,level:2,boundBox:{minX:-45,minY:45,maxX:0,maxY:90}},{x:2,y:0,level:2,boundBox:{minX:-90,minY:45,maxX:-45,maxY:90}},{x:0,y:1,level:2,boundBox:{minX:-180,minY:0,maxX:-135,maxY:45}},{x:1,y:0,level:2,boundBox:{minX:-135,minY:45,maxX:-90,maxY:90}},{x:0,y:0,level:2,boundBox:{minX:-180,minY:45,maxX:-135,maxY:90}}];let n=null,l=null;const d=M("ç»åº¦: 0.000000, çº¬åº¦: 0.000000, æµ·æ‹”: 0.00ç±³");U(async()=>{if(!window.Cesium&&window.loadCesiumResources){console.log("å¼€å§‹åŠ è½½ Cesium èµ„æº...");try{await window.loadCesiumResources(),console.log("Cesium èµ„æºåŠ è½½å®Œæˆï¼")}catch(e){console.error("Cesium åŠ è½½å¤±è´¥ï¼š",e);return}}h(),b(),await T()}),W(()=>{l&&(l.destroy(),l=null),n&&(n.destroy(),n=null)});function h(){n=new _("cesiumContainer",{imageryProvider:!1,terrainProvider:void 0,baseLayerPicker:!1,geocoder:!1,homeButton:!1,infoBox:!1,selectionIndicator:!1,timeline:!1,animation:!1,sceneModePicker:!1,navigationHelpButton:!1,shouldAnimate:!0}),u(0),n._cesiumWidget._creditContainer.style.display="none",n.scene.globe.terrainExaggeration=1,n.scene.globe.terrainExaggerationRelativeHeight=0}function b(){l=new L(n.scene.canvas),l.setInputAction(e=>{const i=n.camera.getPickRay(e.endPosition);if(!i)return;const o=n.scene.globe.pick(i,n.scene);if(o){const t=I.fromCartesian(o),r=s.toDegrees(t.longitude).toFixed(6),m=s.toDegrees(t.latitude).toFixed(6),E=t.height.toFixed(2);d.value=`ç»åº¦: ${r}, çº¬åº¦: ${m}, æµ·æ‹”: ${E}ç±³`}},P.MOUSE_MOVE)}async function T(){window.Cesium={...R};try{await X(y),w()}catch(e){console.error("å¤©åœ°å›¾æ’ä»¶åŠ è½½æˆ–åˆå§‹åŒ–å¤±è´¥",e)}}function w(){const e=n.imageryLayers,i=new x({url:j,tilingScheme:new f,maximumLevel:20});e.addImageryProvider(i);const o=new x({url:`https://t0.tianditu.gov.cn/cia_w/wmts?SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&LAYER=cia&STYLE=default&FORMAT=tiles&TILEMATRIXSET=w&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=${c}`,tilingScheme:new f,maximumLevel:20});e.addImageryProvider(o);const t=["0","1","2","3","4","5","6","7"],r=t.map(m=>`https://t${m}.tianditu.gov.cn/mapservice/swdx?T=elv_c&tk=${c}`);window.Cesium.GeoTerrainProvider&&(n.terrainProvider=new window.Cesium.GeoTerrainProvider({urls:r})),window.Cesium.GeoWTFS&&C(t)}function C(e){const i=new window.Cesium.GeoWTFS({viewer:n,subdomains:e,metadata:{boundBox:{minX:-180,minY:-90,maxX:180,maxY:90},minLevel:1,maxLevel:20},depthTestOptimization:!0,dTOElevation:15e3,dTOPitch:s.toRadians(-70),aotuCollide:!0,collisionPadding:[5,10,8,5],serverFirstStyle:!0,labelGraphics:{font:"28px sans-serif",fontSize:28,fillColor:v.WHITE,scale:.5,outlineColor:v.BLACK,outlineWidth:2,style:D.FILL_AND_OUTLINE,showBackground:!1,pixelOffset:new O(5,5)},billboardGraphics:{width:18,height:18}});i.getTileUrl=function(){return`https://t0.tianditu.gov.cn/mapservice/GetTiles?lxys={z},{x},{y}&VERSION=1.0.0&tk=${c}`},i.getIcoUrl=function(){return`https://t0.tianditu.gov.cn/mapservice/GetIcon?id={id}&tk=${c}`},i.initTDT(g)}async function X(e){if(window.Cesium.GeoWTFS)return;const i=Object.defineProperty;Object.defineProperty=function(o,t,r){if(["primitiveAdded","primitiveRemoved","primitiveMoved"].includes(t))try{return i.call(this,o,t,r)}catch{return o}return i.call(this,o,t,r)};try{for(const o of e)await Y(o)}finally{Object.defineProperty=i}}function Y(e){return new Promise((i,o)=>{const t=document.createElement("script");t.src=e,t.onload=i,t.onerror=o,document.head.appendChild(t)})}function u(e){if(!n)return;const i=typeof e=="number"?e:2;n.camera.flyTo({destination:p.fromDegrees(104.1954,35.8617,15e6),orientation:{heading:0,pitch:-s.PI_OVER_TWO,roll:0},duration:i})}function S(){n&&n.camera.flyTo({destination:p.fromDegrees(86.925,27.9881,9e3),orientation:{heading:s.toRadians(0),pitch:s.toRadians(-25),roll:0},duration:3})}async function B(){if(n)try{const e=await k.fromUrl("https://raw.githubusercontent.com/CesiumGS/3d-tiles-samples/master/1.0/TilesetWithDiscreteLOD/tileset.json");n.scene.primitives.add(e),n.flyTo(e,{duration:3,offset:new A(s.toRadians(0),s.toRadians(-25),e.boundingSphere.radius*2.5)})}catch(e){console.error(`åŠ è½½æ¨¡å‹å¤±è´¥: ${e}`),alert("åŠ è½½3Dæ¨¡å‹å¤±è´¥ï¼Œå¯èƒ½æ˜¯ç½‘ç»œåŸå› æ— æ³•è®¿é—® GitHub èµ„æºã€‚")}}return(e,i)=>(V(),F(H,null,[i[2]||(i[2]=a("div",{id:"cesiumContainer",class:"cesium-container"},null,-1)),a("div",z,[a("div",N,$(d.value),1),i[1]||(i[1]=a("div",{class:"divider"},null,-1)),a("button",{class:"home-btn",onClick:u,title:"å›åˆ°åˆå§‹ä½ç½®"},i[0]||(i[0]=[a("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor"},[a("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})],-1)]))]),a("div",{class:"cesium-controls"},[a("button",{onClick:S,class:"fly-btn"},"ğŸ”ï¸ é£è¶Šç ç©†æœ—ç›å³°"),a("button",{onClick:B,class:"fly-btn"},"ğŸ¢ åŠ è½½3Dæ¨¡å‹")])],64))}},Z=G(K,[["__scopeId","data-v-21e263a3"]]);export{Z as default};
