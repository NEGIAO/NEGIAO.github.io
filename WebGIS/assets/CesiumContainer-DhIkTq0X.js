import{_ as Y,r as w,o as S,a as B,c as E,b as _,d as a,t as L,F as P}from"./index-qNyjOLjH.js";const I={class:"map-controls-group"},O={class:"mouse-position-content"},m="4267820f43926eaf808d61dc07269beb",M="https://mt3v.gggis.com/maps/vt?lyrs=s&x={x}&y={y}&z={z}",R={__name:"CesiumContainer",setup(D){const d=["https://api.tianditu.gov.cn/cdn/plugins/cesium/Cesium_ext_min.js","https://api.tianditu.gov.cn/cdn/plugins/cesium/long.min.js","https://api.tianditu.gov.cn/cdn/plugins/cesium/bytebuffer.min.js","https://api.tianditu.gov.cn/cdn/plugins/cesium/protobuf.min.js"],x=[{x:6,y:1,level:2,boundBox:{minX:90,minY:0,maxX:135,maxY:45}},{x:7,y:1,level:2,boundBox:{minX:135,minY:0,maxX:180,maxY:45}},{x:6,y:0,level:2,boundBox:{minX:90,minY:45,maxX:135,maxY:90}},{x:7,y:0,level:2,boundBox:{minX:135,minY:45,maxX:180,maxY:90}},{x:5,y:1,level:2,boundBox:{minX:45,minY:0,maxX:90,maxY:45}},{x:4,y:1,level:2,boundBox:{minX:0,minY:0,maxX:45,maxY:45}},{x:5,y:0,level:2,boundBox:{minX:45,minY:45,maxX:90,maxY:90}},{x:4,y:0,level:2,boundBox:{minX:0,minY:45,maxX:45,maxY:90}},{x:6,y:2,level:2,boundBox:{minX:90,minY:-45,maxX:135,maxY:0}},{x:6,y:3,level:2,boundBox:{minX:90,minY:-90,maxX:135,maxY:-45}},{x:7,y:2,level:2,boundBox:{minX:135,minY:-45,maxX:180,maxY:0}},{x:5,y:2,level:2,boundBox:{minX:45,minY:-45,maxX:90,maxY:0}},{x:4,y:2,level:2,boundBox:{minX:0,minY:-45,maxX:45,maxY:0}},{x:3,y:1,level:2,boundBox:{minX:-45,minY:0,maxX:0,maxY:45}},{x:3,y:0,level:2,boundBox:{minX:-45,minY:45,maxX:0,maxY:90}},{x:2,y:0,level:2,boundBox:{minX:-90,minY:45,maxX:-45,maxY:90}},{x:0,y:1,level:2,boundBox:{minX:-180,minY:0,maxX:-135,maxY:45}},{x:1,y:0,level:2,boundBox:{minX:-135,minY:45,maxX:-90,maxY:90}},{x:0,y:0,level:2,boundBox:{minX:-180,minY:45,maxX:-135,maxY:90}}];let n=null,r=null;const u=w("ç»åº¦: 0.000000, çº¬åº¦: 0.000000, æµ·æ‹”: 0.00ç±³");S(async()=>{f(),v(),await p()}),B(()=>{r&&(r.destroy(),r=null),n&&(n.destroy(),n=null)});function f(){n=new Cesium.Viewer("cesiumContainer",{imageryProvider:!1,terrainProvider:void 0,baseLayerPicker:!1,geocoder:!1,homeButton:!1,infoBox:!1,selectionIndicator:!1,timeline:!1,animation:!1,sceneModePicker:!1,navigationHelpButton:!1,shouldAnimate:!0}),c(0),n._cesiumWidget._creditContainer.style.display="none",n.scene.globe.terrainExaggeration=1,n.scene.globe.terrainExaggerationRelativeHeight=0}function v(){r=new Cesium.ScreenSpaceEventHandler(n.scene.canvas),r.setInputAction(i=>{const e=n.camera.getPickRay(i.endPosition);if(!e)return;const o=n.scene.globe.pick(e,n.scene);if(o){const t=Cesium.Cartographic.fromCartesian(o),s=Cesium.Math.toDegrees(t.longitude).toFixed(6),l=Cesium.Math.toDegrees(t.latitude).toFixed(6),X=t.height.toFixed(2);u.value=`ç»åº¦: ${s}, çº¬åº¦: ${l}, æµ·æ‹”: ${X}ç±³`}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)}async function p(){window.Cesium={...Cesium};try{await h(d),y()}catch(i){console.error("å¤©åœ°å›¾æ’ä»¶åŠ è½½æˆ–åˆå§‹åŒ–å¤±è´¥",i)}}function y(){const i=n.imageryLayers,e=new Cesium.UrlTemplateImageryProvider({url:M,tilingScheme:new Cesium.WebMercatorTilingScheme,maximumLevel:20});i.addImageryProvider(e);const o=new Cesium.UrlTemplateImageryProvider({url:`https://t0.tianditu.gov.cn/cia_w/wmts?SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&LAYER=cia&STYLE=default&FORMAT=tiles&TILEMATRIXSET=w&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=${m}`,tilingScheme:new Cesium.WebMercatorTilingScheme,maximumLevel:20});i.addImageryProvider(o);const t=["0","1","2","3","4","5","6","7"],s=t.map(l=>`https://t${l}.tianditu.gov.cn/mapservice/swdx?T=elv_c&tk=${m}`);window.Cesium.GeoTerrainProvider&&(n.terrainProvider=new window.Cesium.GeoTerrainProvider({urls:s})),window.Cesium.GeoWTFS&&g(t)}function g(i){const e=new window.Cesium.GeoWTFS({viewer:n,subdomains:i,metadata:{boundBox:{minX:-180,minY:-90,maxX:180,maxY:90},minLevel:1,maxLevel:20},depthTestOptimization:!0,dTOElevation:15e3,dTOPitch:Cesium.Math.toRadians(-70),aotuCollide:!0,collisionPadding:[5,10,8,5],serverFirstStyle:!0,labelGraphics:{font:"28px sans-serif",fontSize:28,fillColor:Cesium.Color.WHITE,scale:.5,outlineColor:Cesium.Color.BLACK,outlineWidth:2,style:Cesium.LabelStyle.FILL_AND_OUTLINE,showBackground:!1,pixelOffset:new Cesium.Cartesian2(5,5)},billboardGraphics:{width:18,height:18}});e.getTileUrl=function(){return`https://t0.tianditu.gov.cn/mapservice/GetTiles?lxys={z},{x},{y}&VERSION=1.0.0&tk=${m}`},e.getIcoUrl=function(){return`https://t0.tianditu.gov.cn/mapservice/GetIcon?id={id}&tk=${m}`},e.initTDT(x)}async function h(i){if(window.Cesium.GeoWTFS)return;const e=Object.defineProperty;Object.defineProperty=function(o,t,s){if(["primitiveAdded","primitiveRemoved","primitiveMoved"].includes(t))try{return e.call(this,o,t,s)}catch{return o}return e.call(this,o,t,s)};try{for(const o of i)await C(o)}finally{Object.defineProperty=e}}function C(i){return new Promise((e,o)=>{const t=document.createElement("script");t.src=i,t.onload=e,t.onerror=o,document.head.appendChild(t)})}function c(i){if(!n)return;const e=typeof i=="number"?i:2;n.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(104.1954,35.8617,15e6),orientation:{heading:0,pitch:-Cesium.Math.PI_OVER_TWO,roll:0},duration:e})}function b(){n&&n.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(86.925,27.9881,9e3),orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(-25),roll:0},duration:3})}async function T(){if(n)try{const i=await Cesium.Cesium3DTileset.fromUrl("https://raw.githubusercontent.com/CesiumGS/3d-tiles-samples/master/1.0/TilesetWithDiscreteLOD/tileset.json");n.scene.primitives.add(i),n.flyTo(i,{duration:3,offset:new Cesium.HeadingPitchRange(Cesium.Math.toRadians(0),Cesium.Math.toRadians(-25),i.boundingSphere.radius*2.5)})}catch(i){console.error(`åŠ è½½æ¨¡å‹å¤±è´¥: ${i}`),alert("åŠ è½½3Dæ¨¡å‹å¤±è´¥ï¼Œå¯èƒ½æ˜¯ç½‘ç»œåŸå› æ— æ³•è®¿é—® GitHub èµ„æºã€‚")}}return(i,e)=>(_(),E(P,null,[e[2]||(e[2]=a("div",{id:"cesiumContainer",class:"cesium-container"},null,-1)),a("div",I,[a("div",O,L(u.value),1),e[1]||(e[1]=a("div",{class:"divider"},null,-1)),a("button",{class:"home-btn",onClick:c,title:"å›åˆ°åˆå§‹ä½ç½®"},e[0]||(e[0]=[a("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor"},[a("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})],-1)]))]),a("div",{class:"cesium-controls"},[a("button",{onClick:b,class:"fly-btn"},"ğŸ”ï¸ é£è¶Šç ç©†æœ—ç›å³°"),a("button",{onClick:T,class:"fly-btn"},"ğŸ¢ åŠ è½½3Dæ¨¡å‹")])],64))}},G=Y(R,[["__scopeId","data-v-152ebb28"]]);export{G as default};
