import{_ as C,r as S,o as B,a as E,c as _,b as L,d as r,t as P,F as I}from"./index-Bbt5UfSU.js";const O={class:"map-controls-group"},M={class:"mouse-position-content"},c="4267820f43926eaf808d61dc07269beb",R="https://mt3v.gggis.com/maps/vt?lyrs=s&x={x}&y={y}&z={z}",D={__name:"CesiumContainer",setup(k){let e=null;const x=["https://api.tianditu.gov.cn/cdn/plugins/cesium/Cesium_ext_min.js","https://api.tianditu.gov.cn/cdn/plugins/cesium/long.min.js","https://api.tianditu.gov.cn/cdn/plugins/cesium/bytebuffer.min.js","https://api.tianditu.gov.cn/cdn/plugins/cesium/protobuf.min.js"],f=[{x:6,y:1,level:2,boundBox:{minX:90,minY:0,maxX:135,maxY:45}},{x:7,y:1,level:2,boundBox:{minX:135,minY:0,maxX:180,maxY:45}},{x:6,y:0,level:2,boundBox:{minX:90,minY:45,maxX:135,maxY:90}},{x:7,y:0,level:2,boundBox:{minX:135,minY:45,maxX:180,maxY:90}},{x:5,y:1,level:2,boundBox:{minX:45,minY:0,maxX:90,maxY:45}},{x:4,y:1,level:2,boundBox:{minX:0,minY:0,maxX:45,maxY:45}},{x:5,y:0,level:2,boundBox:{minX:45,minY:45,maxX:90,maxY:90}},{x:4,y:0,level:2,boundBox:{minX:0,minY:45,maxX:45,maxY:90}},{x:6,y:2,level:2,boundBox:{minX:90,minY:-45,maxX:135,maxY:0}},{x:6,y:3,level:2,boundBox:{minX:90,minY:-90,maxX:135,maxY:-45}},{x:7,y:2,level:2,boundBox:{minX:135,minY:-45,maxX:180,maxY:0}},{x:5,y:2,level:2,boundBox:{minX:45,minY:-45,maxX:90,maxY:0}},{x:4,y:2,level:2,boundBox:{minX:0,minY:-45,maxX:45,maxY:0}},{x:3,y:1,level:2,boundBox:{minX:-45,minY:0,maxX:0,maxY:45}},{x:3,y:0,level:2,boundBox:{minX:-45,minY:45,maxX:0,maxY:90}},{x:2,y:0,level:2,boundBox:{minX:-90,minY:45,maxX:-45,maxY:90}},{x:0,y:1,level:2,boundBox:{minX:-180,minY:0,maxX:-135,maxY:45}},{x:1,y:0,level:2,boundBox:{minX:-135,minY:45,maxX:-90,maxY:90}},{x:0,y:0,level:2,boundBox:{minX:-180,minY:45,maxX:-135,maxY:90}}];let t=null,l=null;const d=S("ç»åº¦: 0.000000, çº¬åº¦: 0.000000, æµ·æ‹”: 0.00ç±³");B(async()=>{e=await Promise.resolve(e),v(),p(),await y()}),E(()=>{l&&(l.destroy(),l=null),t&&(t.destroy(),t=null)});function v(){t=new e.Viewer("cesiumContainer",{imageryProvider:!1,terrainProvider:void 0,baseLayerPicker:!1,geocoder:!1,homeButton:!1,infoBox:!1,selectionIndicator:!1,timeline:!1,animation:!1,sceneModePicker:!1,navigationHelpButton:!1,shouldAnimate:!0}),u(0),t._cesiumWidget._creditContainer.style.display="none",t.scene.globe.terrainExaggeration=1,t.scene.globe.terrainExaggerationRelativeHeight=0}function p(){l=new e.ScreenSpaceEventHandler(t.scene.canvas),l.setInputAction(i=>{const n=t.camera.getPickRay(i.endPosition);if(!n)return;const a=t.scene.globe.pick(n,t.scene);if(a){const o=e.Cartographic.fromCartesian(a),s=e.Math.toDegrees(o.longitude).toFixed(6),m=e.Math.toDegrees(o.latitude).toFixed(6),w=o.height.toFixed(2);d.value=`ç»åº¦: ${s}, çº¬åº¦: ${m}, æµ·æ‹”: ${w}ç±³`}},e.ScreenSpaceEventType.MOUSE_MOVE)}async function y(){window.Cesium={...e};try{await T(x),g()}catch(i){console.error("å¤©åœ°å›¾æ’ä»¶åŠ è½½æˆ–åˆå§‹åŒ–å¤±è´¥",i)}}function g(){const i=t.imageryLayers,n=new e.UrlTemplateImageryProvider({url:R,tilingScheme:new e.WebMercatorTilingScheme,maximumLevel:20});i.addImageryProvider(n);const a=new e.UrlTemplateImageryProvider({url:`https://t0.tianditu.gov.cn/cia_w/wmts?SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&LAYER=cia&STYLE=default&FORMAT=tiles&TILEMATRIXSET=w&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=${c}`,tilingScheme:new e.WebMercatorTilingScheme,maximumLevel:20});i.addImageryProvider(a);const o=["0","1","2","3","4","5","6","7"],s=o.map(m=>`https://t${m}.tianditu.gov.cn/mapservice/swdx?T=elv_c&tk=${c}`);window.Cesium.GeoTerrainProvider&&(t.terrainProvider=new window.Cesium.GeoTerrainProvider({urls:s})),window.Cesium.GeoWTFS&&h(o)}function h(i){const n=new window.Cesium.GeoWTFS({viewer:t,subdomains:i,metadata:{boundBox:{minX:-180,minY:-90,maxX:180,maxY:90},minLevel:1,maxLevel:20},depthTestOptimization:!0,dTOElevation:15e3,dTOPitch:e.Math.toRadians(-70),aotuCollide:!0,collisionPadding:[5,10,8,5],serverFirstStyle:!0,labelGraphics:{font:"28px sans-serif",fontSize:28,fillColor:e.Color.WHITE,scale:.5,outlineColor:e.Color.BLACK,outlineWidth:2,style:e.LabelStyle.FILL_AND_OUTLINE,showBackground:!1,pixelOffset:new e.Cartesian2(5,5)},billboardGraphics:{width:18,height:18}});n.getTileUrl=function(){return`https://t0.tianditu.gov.cn/mapservice/GetTiles?lxys={z},{x},{y}&VERSION=1.0.0&tk=${c}`},n.getIcoUrl=function(){return`https://t0.tianditu.gov.cn/mapservice/GetIcon?id={id}&tk=${c}`},n.initTDT(f)}async function T(i){if(window.Cesium.GeoWTFS)return;const n=Object.defineProperty;Object.defineProperty=function(a,o,s){if(["primitiveAdded","primitiveRemoved","primitiveMoved"].includes(o))try{return n.call(this,a,o,s)}catch{return a}return n.call(this,a,o,s)};try{for(const a of i)await b(a)}finally{Object.defineProperty=n}}function b(i){return new Promise((n,a)=>{const o=document.createElement("script");o.src=i,o.onload=n,o.onerror=a,document.head.appendChild(o)})}function u(i){if(!t)return;const n=typeof i=="number"?i:2;t.camera.flyTo({destination:e.Cartesian3.fromDegrees(104.1954,35.8617,15e6),orientation:{heading:0,pitch:-e.Math.PI_OVER_TWO,roll:0},duration:n})}function X(){t&&t.camera.flyTo({destination:e.Cartesian3.fromDegrees(86.925,27.9881,9e3),orientation:{heading:e.Math.toRadians(0),pitch:e.Math.toRadians(-25),roll:0},duration:3})}async function Y(){if(t)try{const i=await e.Cesium3DTileset.fromUrl("https://raw.githubusercontent.com/CesiumGS/3d-tiles-samples/master/1.0/TilesetWithDiscreteLOD/tileset.json");t.scene.primitives.add(i),t.flyTo(i,{duration:3,offset:new e.HeadingPitchRange(e.Math.toRadians(0),e.Math.toRadians(-25),i.boundingSphere.radius*2.5)})}catch(i){console.error(`åŠ è½½æ¨¡å‹å¤±è´¥: ${i}`),alert("åŠ è½½3Dæ¨¡å‹å¤±è´¥ï¼Œå¯èƒ½æ˜¯ç½‘ç»œåŸå› æ— æ³•è®¿é—® GitHub èµ„æºã€‚")}}return(i,n)=>(L(),_(I,null,[n[2]||(n[2]=r("div",{id:"cesiumContainer",class:"cesium-container"},null,-1)),r("div",O,[r("div",M,P(d.value),1),n[1]||(n[1]=r("div",{class:"divider"},null,-1)),r("button",{class:"home-btn",onClick:u,title:"å›åˆ°åˆå§‹ä½ç½®"},n[0]||(n[0]=[r("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor"},[r("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"})],-1)]))]),r("div",{class:"cesium-controls"},[r("button",{onClick:X,class:"fly-btn"},"ğŸ”ï¸ é£è¶Šç ç©†æœ—ç›å³°"),r("button",{onClick:Y,class:"fly-btn"},"ğŸ¢ åŠ è½½3Dæ¨¡å‹")])],64))}},W=C(D,[["__scopeId","data-v-415f1925"]]);export{W as default};
