# -*-coding:utf-8 -*-
# -------------------------------------------------
# Name:关注度
# Author:NEGIAO
# Created on:2025/7/19 10:03
# Version:1.0
# Reference:
"""
Description: 宝藏小城数据词云图(随机数据版)
Usage: 生成宝藏小城城市关注度词云图(全屏显示)
"""
# --------------------------------------------------
import random
from pyecharts import options as opts
from pyecharts.charts import WordCloud
from pyecharts.globals import ThemeType

# 生成随机城市数据
cities = [
    "北京", "上海", "广州", "深圳", "杭州", "南京", "武汉", "成都", "重庆", "西安",
    "长沙", "苏州", "天津", "郑州", "青岛", "大连", "宁波", "厦门", "福州", "哈尔滨",
    "济南", "太原", "沈阳", "西宁", "兰州", "银川", "呼和浩特", "拉萨", "昆明", "贵阳",
    "南宁", "合肥", "南昌", "石家庄", "长春", "海口", "乌鲁木齐", "东莞", "佛山", "无锡",
    "烟台", "唐山", "徐州", "常州", "温州", "绍兴", "淄博", "泉州", "南通", "镇江"
]

# 生成随机数据
words = [(city, random.randint(1, 100)) for city in cities]

# 创建全屏词云图
c = (
    WordCloud(init_opts=opts.InitOpts(
        width="100%",  # 宽度设为100%
        height="100vh",  # 高度设为100视口高度
        theme=ThemeType.LIGHT  # 使用明亮主题
    ))
    .add(
        "",
        words,
        word_size_range=[15, 120],  # 调整字体大小范围
        textstyle_opts=opts.TextStyleOpts(font_family="微软雅黑"),
        mask_image="",  # 不使用蒙版
        is_draw_out_of_bound=False,  # 防止词语绘制到外部
        shape="circle"  # 形状设为圆形
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(
            title="宝藏小城城市关注度词云图",
            pos_left="center",
            title_textstyle_opts=opts.TextStyleOpts(font_size=30)
        ),
        tooltip_opts=opts.TooltipOpts(is_show=True)  # 显示提示框
    )
)

# 添加JavaScript代码实现自适应全屏
js_code = """
<script>
    document.addEventListener('DOMContentLoaded', function() {
        var chart = document.querySelector('.chart-container');
        chart.style.width = window.innerWidth + 'px';
        chart.style.height = window.innerHeight + 'px';
        
        window.addEventListener('resize', function() {
            chart.style.width = window.innerWidth + 'px';
            chart.style.height = window.innerHeight + 'px';
            chart.querySelector('div').style.width = '100%';
            chart.querySelector('div').style.height = '100%';
            chart.querySelector('canvas').style.width = '100%';
            chart.querySelector('canvas').style.height = '100%';
        });
    });
</script>
"""

# 渲染HTML文件
html = c.render("宝藏小城城市关注度词云图_全屏.html")

# 打开文件添加自适应脚本
with open("宝藏小城城市关注度词云图_全屏.html", "r+", encoding="utf-8") as f:
    content = f.read()
    # 在</body>标签前添加自适应脚本
    f.seek(0)
    f.write(content.replace("</body>", js_code + "</body>"))

print("已生成全屏词云图: 宝藏小城城市关注度词云图_全屏.html")
